<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bike Rental Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .prediction-container {
            max-width: 900px;
            margin: 0 auto;
        }
        .hero-section {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInUp 0.6s ease-out;
        }
        .hero-section h1 {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 12px;
            background: linear-gradient(135deg, #667eea, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .hero-section p {
            color: var(--text-muted);
            font-size: 16px;
        }
        .dataset-selector {
            margin-bottom: 32px;
            animation: fadeInUp 0.7s ease-out;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            animation: fadeInUp 0.8s ease-out;
        }
        .form-group {
            margin-bottom: 0;
        }
        .prediction-result {
            margin-top: 32px;
            padding: 24px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(240, 147, 251, 0.1));
            border-radius: 16px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            text-align: center;
            animation: fadeInUp 0.9s ease-out;
        }
        .prediction-result h2 {
            font-size: 32px;
            margin: 0;
            color: var(--accent);
        }
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            flex-wrap: wrap;
        }
        .action-buttons button {
            flex: 1;
            min-width: 200px;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div class="topnav">
        <div class="left">
            <a href="/">Home</a>
            <a class="active" href="{{ url_for('index', dataset=selected_dataset or 'day') }}">Prediction</a>
            <a href="{{ url_for('insights') }}">AI Insights</a>
            <a href="{{ url_for('chatbot') }}">Chatbot</a>
            <a href="{{ url_for('contact') }}">Contact</a>
        </div>
        <div class="right">
            <span style="color: var(--text-muted); margin-right: 16px;">üë§ Admin</span>
            <a href="{{ url_for('logout') }}">Logout</a>
        </div>
    </div>

    <div class="container prediction-container">
        <div class="hero-section">
            <h1>üö¥ Bike Rental Prediction</h1>
            <p>Get accurate predictions for bike rental demand using AI-powered models</p>
        </div>

        <!-- Pickle File Selection -->
        <form action="{{ url_for('filter_data') }}" method="post" class="dataset-selector">
            <fieldset>
                <legend>ÔøΩ Select Pickle File</legend>
                <div style="display: flex; gap: 16px; align-items: center;">
                    <select id="dataset" name="dataset" style="flex: 1;">
                        <option value="day" {% if selected_dataset=='day' %}selected{% endif %}>üìÖ Daily Pickle (day_data.pkl)</option>
                        <option value="hour" {% if selected_dataset=='hour' %}selected{% endif %}>üïê Hourly Pickle (hour_data.pkl)</option>
                    </select>
                    <button type="submit" style="flex: 0 0 auto; min-width: 150px;">Load Pickle File</button>
                </div>
                <p style="color: var(--text-muted); font-size: 13px; margin-top: 8px; margin-bottom: 0;">
                    üí° Using optimized pickle files for faster predictions
                </p>
            </fieldset>
        </form>

        <!-- Prediction Form -->
        <form action="{{ url_for('predict') }}" method="post" style="animation: fadeInUp 0.8s ease-out;">
            <input type="hidden" name="dataset" value="{{ selected_dataset or 'day' }}" />
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="weather">üå§Ô∏è Weather Condition</label>
                    <select id="weather" name="weather" required>
                        <option value="1">Clear / Partly Cloudy</option>
                        <option value="2">Mist / Cloudy</option>
                        <option value="3">Light Rain / Snow</option>
                        <option value="4">Heavy Rain / Snow</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="season">üçÇ Season</label>
                    <select id="season" name="Seasons" required>
                        <option value="1">Spring</option>
                        <option value="2">Summer</option>
                        <option value="3">Fall</option>
                        <option value="4">Winter</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="temperature">üå°Ô∏è Temperature (normalized)</label>
                    <input type="number" step="0.01" id="temperature" name="temp" placeholder="0.0 - 1.0" required>
                </div>

                <div class="form-group">
                    <label for="humidity">üíß Humidity (normalized)</label>
                    <input type="number" step="0.01" id="humidity" name="hum" placeholder="0.0 - 1.0" required>
                </div>

                <div class="form-group">
                    <label for="month">üìÖ Month</label>
                    <select id="month" name="Month" required>
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="windspeed">üí® Windspeed (normalized)</label>
                    <input type="number" step="0.01" id="windspeed" name="windspeed" placeholder="0.0 - 1.0" required>
                </div>

                <div class="form-group">
                    <label for="year">üìÜ Year</label>
                    <select id="year" name="yr" required>
                        <option value="0">2011 (baseline)</option>
                        <option value="1">2012+</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="holiday">üéâ Holiday?</label>
                    <select id="holiday" name="holiday" required>
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
            </div>

            <div style="margin-top: 32px; text-align: center;">
                <button type="submit" style="min-width: 300px; font-size: 18px;">
                    üîÆ Get Prediction
                </button>
            </div>

            {% if prediction_text %}
            <div class="prediction-result">
                <h2>{{ prediction_text }}</h2>
                <p class="muted">Based on {{ selected_dataset or 'day' }} model with {{ '53' if (selected_dataset or 'day')=='day' else '55' }} engineered features</p>
            </div>
            {% endif %}

            <div class="action-buttons">
                <button type="button" onclick="location.href='/';" style="background: rgba(255,255,255,0.05);">
                    ‚Üê Back to Home
                </button>
            </div>
        </form>
    </div>
</body>
</html>
